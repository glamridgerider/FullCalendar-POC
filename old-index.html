<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
  <meta name="description" content="Event Calendar using FullCalendar and Bootstrap 5">
  <title>FullCalendar Bootstrap 5 Example</title>
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" 
        rel="stylesheet" 
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" 
        crossorigin="anonymous">
  <!-- FullCalendar CSS -->
  <link href="https://cdn.jsdelivr.net/npm/@fullcalendar/bootstrap5@6.1.10/main.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@fullcalendar/daygrid@6.1.10/main.min.css" rel="stylesheet">
  
  <style>
    .fc { /* Calendar container */
      max-width: 1200px;
      margin: 0 auto;
      font-family: Arial, Helvetica, sans-serif;
    }
    .fc .fc-toolbar-title { /* Calendar title */
      font-size: 1.5em;
      font-weight: bold;
      color: #2c3e50;
    }
    .fc .fc-button-primary { /* Calendar buttons */
      background-color: #2c3e50;
      border-color: #2c3e50;
    }
    .fc .fc-button-primary:hover {
      background-color: #1a252f;
      border-color: #1a252f;
    }
    .fc .fc-daygrid-day:hover { /* Calendar day hover effect */
      background-color: rgba(44, 62, 80, 0.1);
    }
    .modal-content {
      border-radius: 0.5rem;
    }
    .modal-header {
      background-color: #f8f9fa;
      border-radius: 0.5rem 0.5rem 0 0;
    }
  </style>
</head>
<body>
  <div class="container my-5">
    <h1 class="mb-4">My Event Calendar</h1>
    <div id="calendar"></div>
  </div>

  <!-- Bootstrap Modal -->
  <div class="modal fade" id="eventModal" tabindex="-1" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalTitle"></h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="modalBody"></div>
        <div class="modal-footer">
          <a id="gcal-link" class="btn btn-outline-primary" target="_blank">Add to Google Calendar</a>
          <a id="ics-link" class="btn btn-outline-secondary" download="event.ics">Download .ICS</a>
        </div>
      </div>
    </div>
  </div>

  <!-- JS dependencies -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fullcalendar/core@6.1.10/index.global.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fullcalendar/daygrid@6.1.10/index.global.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fullcalendar/bootstrap5@6.1.10/index.global.min.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const calendarEl = document.getElementById('calendar');
      
      if (!calendarEl) {
        console.error('Calendar element not found');
        return;
      }

      const calendar = new FullCalendar.Calendar(calendarEl, {
        plugins: [FullCalendar.dayGridPlugin, FullCalendar.bootstrap5Plugin],
        themeSystem: 'bootstrap5',
        initialView: 'dayGridMonth',
        headerToolbar: {
          left: 'prev,next today',
          center: 'title',
          right: 'dayGridMonth,dayGridWeek,dayGridDay'
        },
        buttonIcons: {
          prev: 'chevron-left',
          next: 'chevron-right'
        },
        events: [
          {
            title: 'Meeting with Bob',
            start: '2025-06-10T14:00:00',
            end: '2025-06-10T15:00:00',
            extendedProps: {
              description: 'Discuss project status and next steps.',
              location: 'Zoom Meeting'
            }
          },
          {
            title: 'Lunch with Sarah',
            start: '2025-06-12T12:30:00',
            end: '2025-06-12T13:30:00',
            extendedProps: {
              description: 'Catch-up lunch at the new cafe downtown.',
              location: 'Downtown Cafe'
            }
          }
        ],
        eventDidMount: function(info) {
          // Add Bootstrap tooltips to events
          const tooltip = new bootstrap.Tooltip(info.el, {
            title: info.event.extendedProps.description || '',
            placement: 'top',
            trigger: 'hover',
            container: 'body'
          });
        },
        eventClick: function (info) {
          info.jsEvent.preventDefault();

          const event = info.event;
          const start = event.start;
          const end = event.end || new Date(start.getTime() + 60 * 60 * 1000);

          const modalEl = document.getElementById('eventModal');
          if (!modalEl) {
            console.error('Modal element not found');
            return;
          }

          document.getElementById('modalTitle').innerText = event.title;
          document.getElementById('modalBody').innerHTML = `
            <p><strong>Description:</strong> ${event.extendedProps.description || 'No description available'}</p>
            <p><strong>Location:</strong> ${event.extendedProps.location || 'No location specified'}</p>
            <p><strong>Time:</strong> ${start.toLocaleTimeString()} - ${end.toLocaleTimeString()}</p>
          `;

          document.getElementById('gcal-link').href = generateGoogleCalendarLink(event, start, end);
          document.getElementById('ics-link').href = generateICS(event, start, end);

          const modal = new bootstrap.Modal(modalEl);
          modal.show();
        }
      });

      try {
        calendar.render();
      } catch (error) {
        console.error('Error rendering calendar:', error);
      }
    });

    function generateGoogleCalendarLink(event, start, end) {
      const format = (d) => d.toISOString().replace(/-|:|\.\d\d\d/g, '');
      const title = encodeURIComponent(event.title);
      const details = encodeURIComponent(event.extendedProps.description || '');
      const location = encodeURIComponent(event.extendedProps.location || '');
      return `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${title}&dates=${format(start)}/${format(end)}&details=${details}&location=${location}`;
    }

    function generateICS(event, start, end) {
      const format = (d) => d.toISOString().replace(/-|:|\.\d\d\d/g, '');
      const content = `BEGIN:VCALENDAR\nVERSION:2.0\nBEGIN:VEVENT\nSUMMARY:${event.title}\nDESCRIPTION:${event.extendedProps.description || ''}\nLOCATION:${event.extendedProps.location || ''}\nDTSTART:${format(start)}\nDTEND:${format(end)}\nEND:VEVENT\nEND:VCALENDAR`;
      const blob = new Blob([content], { type: 'text/calendar;charset=utf-8' });
      return URL.createObjectURL(blob);
    }
  </script>
</body>
</html>